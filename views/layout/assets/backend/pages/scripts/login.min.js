var Login = function() {
    
	var globalURLEnlacemeConnection = 'http://localhost/www.enlaceme.com/';
    
	var e = function() {
			$(".login-form").validate({
				errorElement: "span",
				errorClass: "help-block",
				focusInvalid: !1,
				rules: {
					username: {
						required: !0
					},
					password: {
						required: !0
					},
					remember: {
						required: !1
					}
				},
				messages: {
					username: {
						required: "El correo electrónico es requerido."
					},
					password: {
						required: "La contraseña es requerida."
					}
				},
				invalidHandler: function(e, r) {
					$(".alert-danger", $(".login-form")).show()
				},
				highlight: function(e) {
					$(e).closest(".form-group").addClass("has-error")
				},
				success: function(e) {
					e.closest(".form-group").removeClass("has-error"), e.remove()
				},
				errorPlacement: function(e, r) {
					e.insertAfter(r.closest(".input-icon"))
				},
				submitHandler: function(e) {
                    //e.submit();
                     var vUserName, vUserCode;
                     $.ajax({
                         type: 'POST',
                         url: globalURLEnlacemeConnection + 'login/access/',
                         data: $(e).serialize(),
                         dataType: 'json',                         
                         success: function (response) {
                                
                                if(response == 2){
                                    alert('Contraseña incorrecta!');    
                                }
                             
                                $.each(response, function() {
                                    vUserName = response.vUserName;
                                    vUserCode = response.vUserCode;
                                });

                                $(".login-form").hide();
                                $('#enlaceme-message').html('<h3 class="font-white">Bienvenido, <strong class="font-orange">'+vUserName+'</strong></h3>')
                                    .append('<p class="font-white">Por favor, espere unos segundos...</p>')
                                    .hide()
                                    .fadeIn(1000, function () {
                                            setTimeout(function(e){
                                                window.location = globalURLEnlacemeConnection + 'profile/account';
                                                e.preventDefault();
                                            },1000);                                
                                        });
                                }
                            });
                     return false; // required to block normal submit since you used ajax
				}
			}), $(".login-form input").keypress(function(e) {
				return 13 == e.which ? ($(".login-form").validate().form() && $(".login-form").submit(), !1) : void 0
			})
		},
		r = function() {
			$(".forget-form").validate({
				errorElement: "span",
				errorClass: "help-block",
				focusInvalid: !1,
				ignore: "",
				rules: {
					email: {
						required: !0,
						email: !0
					}
				},
				messages: {
					email: {
						required: "Email is required."
					}
				},
				invalidHandler: function(e, r) {},
				highlight: function(e) {
					$(e).closest(".form-group").addClass("has-error")
				},
				success: function(e) {
					e.closest(".form-group").removeClass("has-error"), e.remove()
				},
				errorPlacement: function(e, r) {
					e.insertAfter(r.closest(".input-icon"))
				},
				submitHandler: function(e) {
					e.submit()
				}
			}), $(".forget-form input").keypress(function(e) {
				return 13 == e.which ? ($(".forget-form").validate().form() && $(".forget-form").submit(), !1) : void 0
			}), jQuery("#forget-password").click(function() {
				jQuery(".login-form").hide(), jQuery(".forget-form").show()
			}), jQuery("#back-btn").click(function() {
				jQuery(".login-form").show(), jQuery(".forget-form").hide()
			})
		},
		s = function() {
			function e(e) {
				if (!e.id) return e.text;
				var r = $('<span><img src="' + globalURLEnlacemeConnection + 'views/layout/assets/backend/global/img/flags/' + e.element.value.toLowerCase() + '.png" class="img-flag" /> ' + e.text + "</span>");
				return r
			}
			jQuery().select2 && $("#country_list").size() > 0 && ($("#country_list").select2({
				placeholder: '<i class="fa fa-map-marker"></i>&nbsp;Seleccionar País',
				templateResult: e,
				templateSelection: e,
				width: "auto",
				escapeMarkup: function(e) {
					return e
				}
			}), $("#country_list").change(function() {
				$(".register-form").validate().element($(this))
			})), $(".register-form").validate({
				errorElement: "span",
				errorClass: "help-block",
				focusInvalid: !1,
				ignore: "",
				rules: {
					firstnames: {
						required: !0
					},
					lastnames: {
						required: !0
					},                    
					email: {
						required: !0,
						email: !0
					},
					country: {
						required: !0
					},
					username: {
						required: !0
					},
					password: {
						required: !0
					},
					rpassword: {
						equalTo: "#register_password"
					},
					tnc: {
						required: !0
					}
				},
				messages: {
					firstnames: {
						required: "Registra al menos un nombre."
					},
					lastnames: {
						required: "Registra tus apellidos."
					},                    
					email: {
						required: "Debes registrar tu correo electrónico."
					},
					country: {
						required: "Selecciona tu país de origen."
					},
					password: {
						required: "Ingresa una contraseña."
					},
					rpassword: {
                        required: "Las contraseñas deben ser iguales."
					},                   
					tnc: {
						required: "Por favor debes aceptar nuestros Términos y Condiciones."
					}
				},
				invalidHandler: function(e, r) {},
				highlight: function(e) {
					$(e).closest(".form-group").addClass("has-error")
				},
				success: function(e) {
					e.closest(".form-group").removeClass("has-error"), e.remove()
				},
				errorPlacement: function(e, r) {
					"tnc" == r.attr("name") ? e.insertAfter($("#register_tnc_error")) : 1 === r.closest(".input-icon").size() ? e.insertAfter(r.closest(".input-icon")) : e.insertAfter(r)
				},
				submitHandler: function(e) {
                    //e.submit();
                     $.ajax({
                         type: 'POST',
                         url: globalURLEnlacemeConnection + 'login/register/',
                         data: $(e).serialize(),
                         dataType: 'json',                         
                         success: function (response) {
                                 if(response == 1){
                                    $('#enlaceme-message').html('<h3 class="font-white">Lo sentimos mucho, el correo electrónico <strong class="font-orange">Correo Electrónico</strong> ya se encuentra registrado, por favor solicite el cambio de contraseña si no la recuerde.</h3>')
                                        .hide()
                                        .fadeIn(1000)
                                        .fadeOut(5000);
                                 } else {
                                    
                                    var vUserName, vUserCode; 
                                    $.each(response, function() {
                                        vUserName = response.vUserName;
                                        vUserCode = response.vUserCode;
                                    });
                                    
                                    $(".register-form").hide();
                                    $('#enlaceme-message').html('<h3 class="font-white">Bienvenido <strong class="font-orange">'+vUserName+'</strong></h3>')
                                        .append('<p class="font-white">Por favor, espere unos segundos...</p>')
                                        .hide()
                                        .fadeIn(1000, function() {
                                                setTimeout(function(e){
                                                    window.location = globalURLEnlacemeConnection + 'profile/account';
                                                    e.preventDefault();
                                                },1000);                                
                                            });
                                 }
                            }
                        });
				}
			}), $(".register-form input").keypress(function(e) {
				return 13 == e.which ? ($(".register-form").validate().form() && $(".register-form").submit(), !1) : void 0
			}), jQuery("#register-btn").click(function() {
				jQuery(".login-form").hide(), jQuery(".register-form").show()
			}), jQuery("#register-back-btn").click(function() {
				jQuery(".login-form").show(), jQuery(".register-form").hide()
			})
		};
	return {
		init: function() {
			e(), r(), s(), $.backstretch([globalURLEnlacemeConnection + "views/layout/assets/backend/pages/img/login_bg/1.jpg", globalURLEnlacemeConnection + "views/layout/assets/backend/pages/img/login_bg/2.jpg", globalURLEnlacemeConnection + "views/layout/assets/backend/pages/img/login_bg/3.jpg", globalURLEnlacemeConnection + "views/layout/assets/backend/pages/img/login_bg/4.jpg"], {
				fade: 1e3,
				duration: 8e3
			})
		}
	}
}();
jQuery(document).ready(function() {
	Login.init()
});