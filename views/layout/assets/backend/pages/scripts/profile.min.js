var PersonalProfile = function() {
	
    var globalURLEnlacemeConnection = 'http://localhost/www.enlaceme.com/';
    
	var vProfileImage = function() {
            $("#form-upload-image-profile").submit(function(e){
				var data = new FormData(this);
				$.ajax({
					type: 'POST',
					url: globalURLEnlacemeConnection + 'images/regProfileImage/',
					data: data,
					processData: false,
					contentType: false,
					beforeSend: function(){
                            count = 0;
                            val = $.trim( $('#imageFile').val() );

                            if( val == '' ){
                                count= 1;
                                $('#message_img').html('<div class="alert alert-danger"><strong>Incorrecto!</strong> Selecciona una imagen por favor.</div>')
                                    .hide()
                                    .fadeIn(1000);
                                return false;
                            }
                            
                            if(count == 0){
                                for (var i = 0; i < $('#imageFile').get(0).files.length; ++i) {
                                    img = $('#imageFile').get(0).files[i].name;
                                    var extension = img.split('.').pop().toUpperCase();
                                    if(extension!="PNG" && extension!="JPG" && extension!="GIF" && extension!="JPEG"){
                                        count= count+ 1
                                    }
                                }
                                if( count > 0){
                                    $('#message_img').html('<div class="alert alert-danger"><strong>Incorrecto!</strong> Selecciona una imagen válida por favor.</div>')
                                        .hide()
                                        .fadeIn(1000);
                                    return false;
                                } 
						      }

                            if(count > 0){
                                return false;
                            }
					},
					success: function(arrayResult){
                        //$('#message_img').hide();
                        var vImageCode = arrayResult;
                        $.ajax({
                            type: 'POST',
                            url: globalURLEnlacemeConnection + 'profile/regProfileImage/',
                            data: {'vImageCode': vImageCode},                       
                            success: function (response) {
                                    $('#message_img').html('<div class="alert alert-success"><strong>Correcto!</strong> La imagen del Perfil se guardo.</div>')
                                        .hide()
                                        .fadeIn(1000, function () {
                                        setTimeout(function(sto){
                                            window.location = globalURLEnlacemeConnection + 'profile/cropimage';
                                            sto.preventDefault();
                                        },2000);                                
                                    });
                                }
                        });
					}
				});
                e.preventDefault();
            });
		};
    
	var vProfileData = function() {
            $(".form-register-profile").submit(function(e){
                $.ajax({
                    type: 'POST',
                    url: globalURLEnlacemeConnection + 'profile/regAccountProfileData/',
                    data: $(this).serialize(),
                    dataType: 'json',                         
                    success: function (response) {
                            alert(response);
                        }
                });
                e.preventDefault();
            });
		};    
    
	var vProfileInfoData = function(e) {
            $(".form-register-profession").submit(function(e){
                $.ajax({
                    type: 'POST',
                    url: globalURLEnlacemeConnection + 'profile/regProfessionProfileData/',
                    data: $(this).serialize(),
                    dataType: 'json',                         
                    success: function (response) {
                            $('#message_img').html('<div class="alert alert-success"><strong>Correcto!</strong> Los datos de Descripción Personal se guardaron correctamente.</div>')
                                .hide()
                                .fadeIn(1000, function () {
                                setTimeout(function(sto){
                                    window.location = globalURLEnlacemeConnection + 'profile/account';
                                    sto.preventDefault();
                                },3000);                                
                            });
                        }
                });
                e.preventDefault();
            });
		};
    
	return {
		init: function() {

			vProfileImage(), vProfileData(), vProfileInfoData();
		}
	}
}();
jQuery(document).ready(function() {
	PersonalProfile.init()
});